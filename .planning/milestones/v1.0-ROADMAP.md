# Milestone v1.0: MVP

**Status:** SHIPPED 2025-12-27
**Phases:** 1-6
**Total Plans:** 21

## Overview

Kametrix evolves from an empty Next.js project to a complete self-serve voice AI platform. This milestone covers foundational infrastructure and authentication, user-facing dashboards, Vapi voice agent integration, Google Calendar and Sheets services, Stripe payments with credit tracking, and polish with deployment configuration.

## Phases

### Phase 1: Foundation

**Goal**: Working Next.js project with PostgreSQL database, schema for all entities, and email/password authentication
**Depends on**: Nothing (first phase)
**Plans**: 3 plans

Plans:
- [x] 01-01: Next.js 15 with TypeScript, Tailwind CSS v4, and Prisma setup
- [x] 01-02: Prisma schema with User, Agent, Call, CreditPack, CreditTransaction, PhoneNumber models
- [x] 01-03: Email/password auth with bcrypt, session cookies, and protected route middleware

### Phase 2: Core Dashboard

**Goal**: User dashboard to manage agents and view calls, admin dashboard with full control
**Depends on**: Phase 1
**Plans**: 4 plans

Plans:
- [x] 02-01: Dashboard layout with tab navigation, stats cards, and auth UI
- [x] 02-02: Full CRUD agent management with status cards, toggle switch, and delete confirmation
- [x] 02-03: Call history and credit management views with pagination
- [x] 02-04: Admin dashboard with user, agent, and phone number management

### Phase 3: Vapi Integration

**Goal**: Create and configure voice agents via Vapi, provision phone numbers, handle incoming calls
**Depends on**: Phase 2
**Plans**: 4 plans

Plans:
- [x] 03-01: Vapi SDK integration with typed singleton client and helper modules
- [x] 03-02: Agent creation wizard with AI-powered content generation
- [x] 03-03: Phone pool sync from Vapi with auto-assignment on agent creation
- [x] 03-04: Vapi webhook integration with call record creation and transcript storage

### Phase 4: Google Integrations

**Goal**: OAuth flow for Google, Calendar integration for booking, Sheets integration for logging
**Depends on**: Phase 3
**Plans**: 3 plans

Plans:
- [x] 04-01: Google OAuth2 flow with AES-256-GCM encrypted token storage
- [x] 04-02: Google Calendar integration with Vapi tool calls for appointment booking
- [x] 04-03: Auto-created "Kametrix Call Logs" spreadsheet with non-blocking call logging

### Phase 5: Payments & Credits

**Goal**: Stripe checkout for credit packs, credit usage tracking, grace period for low balance
**Depends on**: Phase 3
**Plans**: 4 plans

Plans:
- [x] 05-01: Stripe SDK, webhook endpoint, and credit pack seeding
- [x] 05-02: Credit purchase flow with Stripe Checkout
- [x] 05-03: Credit deduction on call completion
- [x] 05-04: Low balance warnings at $5 threshold and grace period visibility

### Phase 6: Polish & Launch

**Goal**: Email notifications, webhook support for custom integrations, deployment configuration
**Depends on**: Phase 5
**Plans**: 3 plans

Plans:
- [x] 06-01: Nodemailer SMTP email service with welcome and low credit emails
- [x] 06-02: Health check endpoint and deployment documentation
- [x] 06-03: End-to-end testing and bug fixes (dynamic dates, configurable appointment duration)

---

## Milestone Summary

**Key Decisions:**
- Voice provider: Vapi (end-to-end solution with phone handling built-in)
- Billing: Credit packs (predictable costs, simple to implement)
- Phone numbers: Kametrix provisions (simpler UX than bring-your-own)
- Out-of-credits: Grace period (soft warning, no hard cutoff)
- Tech stack: Next.js 15 + PostgreSQL + Prisma 7 + Tailwind CSS v4
- Auth: Email/password with bcrypt, session cookies
- Token encryption: AES-256-GCM for Google OAuth tokens
- Credit pricing: $0.15/min with ceil rounding
- Low balance threshold: $5 (500 cents, ~33 minutes warning)

**Issues Resolved:**
- Prisma 7 adapter requirement for PostgreSQL
- Edge runtime compatibility in Next.js middleware
- Vapi payload structure variations for duration extraction
- Stale dates in agent system prompts
- Configurable appointment duration

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None significant

---

_For current project status, see .planning/ROADMAP.md_
